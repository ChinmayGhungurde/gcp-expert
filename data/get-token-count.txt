Vertex AI
Documentation
Generative AI
Was this helpful?
Send feedback
Get token count and billable characters
bookmark_border
On this page
Supported models
Get the token count for a prompt
Pricing and quota
What's next
Preview
This feature is a Preview offering, subject to the Pre-GA Offerings Terms of the GCP Service Specific Terms. Pre-GA products and features may have limited support, and changes to pre-GA products and features may not be compatible with other pre-GA versions. For more information, see the launch stage descriptions. Further, by using the PaLM API on Vertex AI, you agree to the Generative AI Preview terms and conditions (Preview Terms).
For PaLM APIs on Vertex AI that are not GA, you can process personal data as outlined in the Cloud Data Processing Addendum, subject to applicable restrictions and obligations in the Agreement (as defined in the Preview Terms).
This page shows you how to get the token count and the number of billable characters for a prompt.
Supported models
The following foundation models support getting prompt token counts:
text-bison
chat-bison
textembedding-gecko
code-bison
codechat-bison
code-gecko
Get the token count for a prompt
You can get the token count and the number of billable characters for a prompt by using the Vertex AI API.
REST
To get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.
Before using any of the request data, make the following replacements:
PROJECT_ID: Your project ID.
MODEL_ID: The name of the model for which you want to get token count and billable characters. The foundation model options are:
text-bison
chat-bison
textembedding-gecko
code-bison (Preview)
codechat-bison (Preview)
code-gecko (Preview)
You can specify a stable version by appending a version number to the model name, such as @001 to the model name. You can also specify a latest version by not appending a version number to the model name. To learn which *stable* model versions are available, see Available stable model versions.
PROMPT: The prompt to get the token count and billable characters for. (Don't add quotes around the prompt here.)
HTTP method and URL:
POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/
PROJECT_ID/locations/us-central1/publishers/google/models/
MODEL_ID:countTokens
Request JSON body:
{
  "instances": [
    { "prompt": "
PROMPT"}
  ],
}
To send your request, choose one of these options:
curl
PowerShell
Note: The following command assumes that you have logged in to the gcloud CLI with your user account by running gcloud init or gcloud auth login, or by using Cloud Shell, which automatically logs you into the gcloud CLI. You can check the currently active account by running gcloud auth list.
Save the request body in a file named request.json. Run the following command in the terminal to create or overwrite this file in the current directory:
cat > request.json << 'EOF'
{
  "instances": [
    { "prompt": "
PROMPT"}
  ],
}
EOF
Then execute the following command to send your REST request:
curl -X POST \
    -H "Authorization: Bearer $(gcloud auth print-access-token)" \
    -H "Content-Type: application/json; charset=utf-8" \
    -d @request.json \
    "https://us-central1-aiplatform.googleapis.com/v1beta1/projects/
PROJECT_ID/locations/us-central1/publishers/google/models/
MODEL_ID:countTokens"








You should receive a JSON response similar to the following.
{
  "totalTokens": 43,
  "totalBillableCharacters": 182
}
Example curl command
MODEL_ID="text-bison"
PROJECT_ID="my-project"
PROMPT="Give me ten interview questions for the role of program manager."

curl \
-X POST \
-H "Authorization: Bearer $(gcloud auth print-access-token)" \
-H "Content-Type: application/json" \
https://us-central1-aiplatform.googleapis.com/v1beta1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/${MODEL_ID}:countTokens -d \
$'{
  "instances": [
    { "prompt": "${PROMPT}"}
  ],
}'
Pricing and quota
There is no charge or quota restrictions for using the CountToken API.
What's next
Learn how to test chat prompts.
Learn how to test text prompts.
Learn how to get text embeddings.
Was this helpful?
Send feedback