Vertex AI
Documentation
Generative AI
Send feedback
Use the Vertex AI SDK to tune models
On this page
Tune a text generation foundation model
What's next
You can use the Vertex AI SDK to tune most models that support tuning. Not all foundation models that support tuning can be tuned using the Vertex AI SDK. To tune a model, run the tune_model method on the model object. The tune_model method supports supervised tuning and doesn't support reinforcement learning from human feedback (RLHF) tuning. For details about using Vertex AI to tune a model, see Tune language foundation models. For a more complete sample of how to tune a text generation model using the Vertex AI SDK, see Create a text model supervised tuning job.
Tune a text generation foundation model
The following steps demonstrate how to use the Vertex AI SDK to tune the text generation foundation model.
Call the from_pretrained method to load a version of the text foundation model. The following loads the most current stable version of the text generation foundation model:
my_text_generation_model = TextGenerationModel.from_pretrained("text-bison@001")
Run the tune_model method to tune your text generation model. tune_model launches a model tuning job and then immediately returns a tuning job object. To make this documentation simple, the parameters in the following code snippet are replaced by an ellipsis (...).
tuning_job = my_text_generation_model.tune_model(...)
Run the get_tuned_model method on the tuning job to get the tuned model. get_tuned_model waits for the tuning job that was started by tune_model to complete before it returns a tuned model.
tuned_model = tuning_job.get_tuned_model()
After you tune a model, use the list_tuned_model_names method to view tuned models. list_tuned_model_names returns tuned models that are of the same model type as the object that called it. For example, if you call list_tuned_models on the TextGenerationModel.from_pretrained("text-bison@001") model object, then only tuned versions of the text-bison@001 model are returned. The following returns the names of tuned text generation models:
text_generaton_model = TextGenerationModel.from_pretrained("text-bison@001")
text_generaton_model.list_tuned_model_names()
What's next
Learn how to use text model classes and the Vertex AI SDK.
Learn how to use code model classes and the Vertex AI SDK.
Learn about Vertex AI SDK classes not related to generative AI.
Send feedback